var THREEx=THREEx||{};THREEx.Planets={};THREEx.Planets.baseURL="assets/img/planets/";
THREEx.Planets.params={sol:{map:"sunmap.jpg",radius:1.2,tilt:7.25,rot:1.0438,corona:{map:"solarcorona.jpg",radius:5.1}},mer:{map:"mercurymap.jpg",bump:"mercurybump.jpg",radius:.3,tilt:0,rot:58.646},ven:{map:"venusmap.jpg",radius:.4,tilt:177.3,rot:4.05},ter:{map:"earthmap1k.jpg",bump:"earthbump1k.jpg",clouds:"earthclouds.png",radius:.4,tilt:23.45,rot:.9973},lun:{map:"moonmap1k.jpg",bump:"moonbump1k.jpg",radius:.25,tilt:1.54,rot:27.3217},mar:{map:"marsmap1k.jpg",bump:"marsbump1k.jpg",clouds:"marsclouds.png",
radius:.35,tilt:25.19,rot:1.026},ves:{map:"vestamap.jpg",bump:"vestabump.jpg",radius:.1,tilt:29,rot:.223},cer:{map:"ceresmap.jpg",radius:.16,tilt:4,rot:.378},jup:{map:"jupitermap.jpg",radius:1.2,tilt:3.12,rot:.414,ring:{map:"jupiterrings.png",radius:2.7,opacity:.5}},sat:{map:"saturnmap.jpg",radius:1.2,tilt:26.73,rot:.444,ring:{map:"saturnrings.png",radius:2.6,opacity:1}},ura:{map:"uranusmap.jpg",radius:1,tilt:97.86,rot:.718,ring:{map:"uranusrings.png",radius:2,opacity:.5}},nep:{map:"neptunemap.jpg",
radius:1,tilt:29.56,rot:.671,ring:{map:"neptunerings.png",radius:2.5,opacity:.8}},plu:{map:"plutomap1k.jpg",radius:.2,tilt:122.53,rot:6.387}};var substitutes={Sun:"sol",Mercury:"mer",Venus:"ven",Earth:"ter",Moon:"lun",Mars:"mar",Vesta:"ves",Ceres:"cer",Jupiter:"jup",Saturn:"sat",Uranus:"ura",Neptune:"nep",Pluto:"plu"};THREEx.Planets.createSun=function(){return THREEx.Planets.create("sun")};THREEx.Planets.createMercury=function(){return THREEx.Planets.create("mercury")};
THREEx.Planets.createVenus=function(){return THREEx.Planets.create("venus")};THREEx.Planets.createEarth=function(){return THREEx.Planets.create("earth",!0)};THREEx.Planets.createMoon=function(){return THREEx.Planets.create("moon")};THREEx.Planets.createMars=function(){return THREEx.Planets.create("mars")};THREEx.Planets.createJupiter=function(){return THREEx.Planets.create("jupiter")};THREEx.Planets.createJupiterRing=function(){return THREEx.Planets.createRing("jupiter")};
THREEx.Planets.createSaturn=function(){return THREEx.Planets.create("saturn",!0)};THREEx.Planets.createSaturnRing=function(){return THREEx.Planets.createRing("saturn")};THREEx.Planets.createUranus=function(){return THREEx.Planets.create("uranus",!0)};THREEx.Planets.createUranusRing=function(){return THREEx.Planets.createRing("uranus")};THREEx.Planets.createNeptune=function(){return THREEx.Planets.create("neptune")};THREEx.Planets.createNeptuneRing=function(){return THREEx.Planets.createRing("neptune")};
THREEx.Planets.createPluto=function(){return THREEx.Planets.create("pluto")};THREEx.Planets.createStarfield=function(){var a=(new THREE.TextureLoader).load(THREEx.Planets.baseURL+"tycho-skymap.jpg"),a=new THREE.MeshBasicMaterial({map:a,side:THREE.BackSide}),b=new THREE.SphereGeometry(1E3,32,32);return new THREE.Mesh(b,a)};
THREEx.Planets.create=function(a,b){if(!THREEx.Planets.params.hasOwnProperty(a))if(substitutes.hasOwnProperty(a))a=substitutes[a];else return console.log("Object not found: "+a),null;var c=THREEx.Planets.params[a],d={},e=new THREE.TextureLoader,f=new THREE.SphereGeometry(1,32,32);d.map=e.load(THREEx.Planets.baseURL+c.map);c.hasOwnProperty("bump")&&(d.bumpMap=e.load(THREEx.Planets.baseURL+c.bump),d.bumpScale=.005);c.hasOwnProperty("spec")&&(d.specularMap=e.load(THREEx.Planets.baseURL+c.spec),d.specular=
new THREE.Color("#333"));d="sol"===a?new THREE.MeshBasicMaterial(d):new THREE.MeshPhongMaterial(d);f=new THREE.Mesh(f,d);!b&&c.hasOwnProperty("ring")&&(f.receiveShadow=!0,f.castShadow=!0,d=THREEx.Planets.createRings(a),d.receiveShadow=!0,d.castShadow=!0,f.add(d));!b&&c.hasOwnProperty("clouds")&&f.add(THREEx.Planets.createClouds(a));b||"sol"!==a||f.add(THREEx.Planets.createCorona());f.rotation.set(THREE.Math.degToRad(25),0,THREE.Math.degToRad(c.tilt));return f};
THREEx.Planets.createRings=function(a){if(!THREEx.Planets.params.hasOwnProperty(a))if(substitutes.hasOwnProperty(a))a=substitutes[a];else return console.log("Object not found: "+a),null;if(!THREEx.Planets.params[a].hasOwnProperty("ring"))return console.log("Rings not found: "+a),null;var b=THREEx.Planets.params[a],c=THREEx.Planets.baseURL+b.ring.map,d=new THREE.TextureLoader,e=new THREEx.Planets.RingGeometry(1.05,b.ring.radius,64,64),b=new THREE.MeshPhongMaterial({map:d.load(c),side:THREE.DoubleSide,
transparent:!0,opacity:b.ring.opacity}),e=new THREE.Mesh(e,b);e.lookAt(new THREE.Vector3(0,1,0));e.name=a+"rings";return e};
THREEx.Planets.createClouds=function(a){if(!THREEx.Planets.params.hasOwnProperty(a))if(substitutes.hasOwnProperty(a))a=substitutes[a];else return console.log("Object not found: "+a),null;if(!THREEx.Planets.params[a].hasOwnProperty("clouds"))return console.log("Clouds not found: "+a),null;var b=THREEx.Planets.baseURL+THREEx.Planets.params[a].clouds,c=new THREE.TextureLoader,b=new THREE.Mesh(new THREE.SphereGeometry(1.01,32,32),new THREE.MeshPhongMaterial({map:c.load(b),transparent:!0}));b.name=a+"clouds";
return b};THREEx.Planets.createCorona=function(){var a=THREEx.Planets.params.sol,b=THREEx.Planets.baseURL+a.corona.map,b=new THREE.SpriteMaterial({map:(new THREE.TextureLoader).load(b),color:16777011,transparent:!1,blending:THREE.AdditiveBlending}),b=new THREE.Sprite(b);b.scale.multiplyScalar(a.corona.radius);b.name="solcorona";return b};
THREEx.createAtmosphereMaterial=function(){return new THREE.ShaderMaterial({uniforms:{coeficient:{type:"f",value:1},power:{type:"f",value:2},glowColor:{type:"c",value:new THREE.Color("pink")}},vertexShader:"varying vec3\tvVertexWorldPosition;\nvarying vec3\tvVertexNormal;\nvoid main(){\n\tvVertexNormal\t= normalize(normalMatrix * normal);\n\tvVertexWorldPosition\t= (modelMatrix * vec4(position, 1.0)).xyz;\n\t// set gl_Position\n\tgl_Position\t= projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",
fragmentShader:"uniform vec3\tglowColor;\nuniform float\tcoeficient;\nuniform float\tpower;\nvarying vec3\tvVertexNormal;\nvarying vec3\tvVertexWorldPosition;\nvoid main(){\n\tvec3 worldCameraToVertex= vVertexWorldPosition - cameraPosition;\n\tvec3 viewCameraToVertex\t= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;\n\tviewCameraToVertex\t= normalize(viewCameraToVertex);\n\tfloat intensity\t\t= pow(coeficient + dot(vVertexNormal, viewCameraToVertex), power);\n\tgl_FragColor\t\t= vec4(glowColor, intensity);\n}",
transparent:!0,depthWrite:!1})};
THREEx.Planets.RingGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};a=a||0;e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(1,d):8;var k=[],n=a,l=((b||50)-a)/d;for(a=0;a<d+1;a++){for(b=0;b<c+1;b++){var g=new THREE.Vector3,h=e+b/c*f;g.x=n*Math.cos(h);g.y=n*Math.sin(h);this.vertices.push(g);k.push(new THREE.Vector2(a/(c-1),
b/(d-1)))}n+=l}e=new THREE.Vector3(0,0,1);for(a=0;a<d;a++)for(f=a*(c+1),b=0;b<c;b++){var l=h=b+f,g=h+c+1,m=h+c+2;this.faces.push(new THREE.Face3(l,g,m,[e.clone(),e.clone(),e.clone()]));this.faceVertexUvs[0].push([k[l].clone(),k[g].clone(),k[m].clone()]);l=h;g=h+c+2;m=h+1;this.faces.push(new THREE.Face3(l,g,m,[e.clone(),e.clone(),e.clone()]));this.faceVertexUvs[0].push([k[l].clone(),k[g].clone(),k[m].clone()])}this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,n)};
THREEx.Planets.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);THREEx.Planets.RingGeometry.prototype.constructor=THREEx.Planets.RingGeometry;
